<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script>
        !function(e) {
            function t(e) {
                if (i) {
                    var t = "cloudwise-agent://timing?" + encodeURIComponent(JSON.stringify(e)),
                            n = document.createElement("iframe");
                    n.setAttribute("src", t),
                            document.documentElement.appendChild(n),
                            n.parentNode.removeChild(n),
                            n = null
                }
            }
            function n() {
                var n = 3e3,
                        r = e.location.href,
                        i = e.location.hostname,
                        a = e.location.pathname;
                setTimeout(function() {
                            var e = {
                                type: "cloudwise_monitor",
                                payload: {
                                    url: r,
                                    domain: i,
                                    uri: a,
                                    navigationTiming: o.getNavigationTiming(),
                                    resourceTiming: o.getResourceTiming(),
                                    error_list: []
                                }
                            };
                            t(e)
                        },
                        0);
                var c = function() {
                    var e = o.getResourceTiming();
                    if (e.length > 0) {
                        var n = {
                            type: "cloudwise_monitor",
                            payload: {
                                url: r,
                                domain: i,
                                uri: a,
                                navigationTiming: {},
                                resourceTiming: e,
                                error_list: []
                            }
                        };
                        t(n)
                    }
                };
                e.setInterval(c, n);
                var s = !0;
                e.addEventListener("beforeunload",
                        function() {
                            s && (s = !1, c())
                        }),
                        e.addEventListener("unload",
                                function() {
                                    s && (s = !1, c())
                                })
            }
            var r = (new Date).getTime(),
                    o = function() {
                        function t() {
                            if (!e.performance || !e.performance.timing) return {};
                            var t = e.performance.timing;
                            return {
                                navigationStart: t.navigationStart,
                                redirectStart: t.redirectStart,
                                redirectEnd: t.redirectEnd,
                                fetchStart: t.fetchStart,
                                domainLookupStart: t.domainLookupStart,
                                domainLookupEnd: t.domainLookupEnd,
                                connectStart: t.connectStart,
                                secureConnectionStart: t.secureConnectionStart ? t.secureConnectionStart: t.connectEnd - t.secureConnectionStart,
                                connectEnd: t.connectEnd,
                                requestStart: t.requestStart,
                                responseStart: t.responseStart,
                                responseEnd: t.responseEnd,
                                unloadEventStart: t.unloadEventStart,
                                unloadEventEnd: t.unloadEventEnd,
                                domLoading: t.domLoading,
                                domInteractive: t.domInteractive,
                                domContentLoadedEventStart: t.domContentLoadedEventStart,
                                domContentLoadedEventEnd: t.domContentLoadedEventEnd || o,
                                domComplete: t.domComplete,
                                loadEventStart: t.loadEventStart,
                                loadEventEnd: t.loadEventEnd,
                                pageTime: r || (new Date).getTime()
                            }
                        }
                        function n() {
                            if (!e.performance || !e.performance.getEntriesByType) return [];
                            for (var t = e.performance.getEntriesByType("resource"), n = [], r = 0; r < t.length; r++) {
                                var o = t[r].secureConnectionStart ? t[r].secureConnectionStart: t[r].connectEnd - t[r].secureConnectionStart,
                                        i = {
                                            connectEnd: t[r].connectEnd,
                                            connectStart: t[r].connectStart,
                                            domainLookupEnd: t[r].domainLookupEnd,
                                            domainLookupStart: t[r].domainLookupStart,
                                            duration: t[r].duration,
                                            entryType: t[r].entryType,
                                            fetchStart: t[r].fetchStart,
                                            initiatorType: t[r].initiatorType,
                                            name: t[r].name,
                                            redirectEnd: t[r].redirectEnd,
                                            redirectStart: t[r].redirectStart,
                                            requestStart: t[r].requestStart,
                                            responseEnd: t[r].responseEnd,
                                            responseStart: t[r].responseStart,
                                            secureConnectionStart: o,
                                            startTime: t[r].startTime
                                        };
                                n.push(i)
                            }
                            return n
                        }
                        var o = (new Date).getTime();
                        return document.addEventListener("DOMContentLoaded",
                                function() {
                                    o = (new Date).getTime()
                                }),
                        {
                            cacheResourceTimingLength: 0,
                            getNavigationTiming: function() {
                                return t()
                            },
                            getResourceTiming: function() {
                                var e = n(),
                                        t = e.length;
                                return e.length != this.cacheResourceTimingLength ? (e = e.slice(this.cacheResourceTimingLength, t), this.cacheResourceTimingLength = t, e) : []
                            }
                        }
                    } (),
                    i = /(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);
            navigator.userAgent.toLowerCase().indexOf("android") > -1;
            e.cloudwiseStartPageMonitor = n
        } (this),

                function() {
                    console.log('sssss');
                    function e(e, t, n) {
                        return e.addEventListener ? e.addEventListener(t, n, !1) : e.attachEvent && e.attachEvent("on" + t, n),
                                this
                    }
                    for (var t = window.location.host,
                                 n = 0,
                                 r = !1,
                                 o = ["iPad", "iPhone", "iPod"]; n < o.length; n++) if (navigator.platform.indexOf(o[n]) >= 0) {
                        r = !0;
                        break
                    }
                    var i = /(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent),
                            a = navigator.userAgent.toLowerCase().indexOf("android") > -1,
                            c = {
                                callbacks: {},
                                send: function(e, t) {
                                    this.dispatchMessage("event", e, t)
                                },
                                sendCallback: function(e) {
                                    var t = s.createEnvelope(e);
                                    this.dispatchMessage("callback", t,
                                            function() {})
                                },
                                triggerCallback: function(e) {
                                    var t = this;
                                    setTimeout(function() {
                                                t.callbacks[e] && t.callbacks[e]()
                                            },
                                            0)
                                },
                                dispatchMessage: function(e, t, n) {
                                    var r = this;
                                    if (this.callbacks[t.id] = function() {
                                                n(),
                                                        delete r.callbacks[t.id]
                                            },
                                                    i) {
                                        var o = "cloudwise://" + e + "/" + t.id + "?" + encodeURIComponent(JSON.stringify(t)),
                                                c = document.createElement("iframe");
                                        c.setAttribute("src", o),
                                                document.documentElement.appendChild(c),
                                                c.parentNode.removeChild(c),
                                                c = null
                                    } else a && jsinterface.send(JSON.stringify(t))
                                }
                            },
                            s = {
                                listeners: {},
                                dispatcher: null,
                                messageCount: 0,
                                on: function(e, t) { (!this.listeners.hasOwnProperty(e) || !this.listeners[e] instanceof Array) && (this.listeners[e] = []),
                                        this.listeners[e].push(t)
                                },
                                off: function(e) { (!this.listeners.hasOwnProperty(e) || !this.listeners[e] instanceof Array) && (this.listeners[e] = []),
                                        this.listeners[e] = []
                                },
                                send: function(e, t, n) {
                                    t instanceof Function && (n = t, t = null),
                                            t = t || {},
                                            n = n ||
                                                    function() {};
                                    var r = this.createEnvelope(this.messageCount, e, t);
                                    this.dispatcher.send(r, n),
                                            this.messageCount += 1
                                },
                                trigger: function(e, t, n) {
                                    for (var r = this,
                                                 o = this.listeners[e] || [], i = 0, a = function() {
                                                i += 1,
                                                i >= o.length && r.dispatcher.sendCallback(t)
                                            },
                                                 c = 0; c < o.length; c++) {
                                        var s = o[c];
                                        s.length <= 1 ? (s(n), a()) : s(n, a)
                                    }
                                },
                                triggerCallback: function(e) {
                                    this.dispatcher.triggerCallback(e)
                                },
                                createEnvelope: function(e, n, r) {
                                    return {
                                        id: e,
                                        type: n,
                                        host: t,
                                        payload: r
                                    }
                                }
                            },
                            d = {
                                send: function(e, t) {
                                    t()
                                },
                                triggerCallback: function() {},
                                sendCallback: function() {}
                            };
                    r && i || a ? s.dispatcher = c: s.dispatcher = d,
                            window.Cloudwise = s,
                            window.CloudwiseAddEvent = function() {
                                function t(e) {
                                    function t(e) {
                                        var r = e.nodeName.toLocaleLowerCase();
                                        "body" != r && "a" != r && t(e.parentNode),
                                        "a" == r && (n = !0)
                                    }
                                    var n = !1;
                                    return t(e.parentNode),
                                            n
                                }
                                for (var n = document.getElementsByTagName("a"), r = 0, o = n.length; o > r; r++) e(n[r], "click",
                                        function(e) {
                                            var t = this.innerText,
                                                    n = this.href;
                                            t = t.replace(/<.*[^>]*>/g, ""),
                                                    s.send("onclick", {
                                                        linkText: t.replace(/[\r\n]/g, ""),
                                                        linkUrl: n
                                                    })
                                        });
                                window.onclick = function(e) {
                                    var n = e.target,
                                            r = t(n);
                                    if (!r) {
                                        var o = n.innerHTML;
                                        o ? o = o.replace(/<.*[^>]*>/g, "") : "img" == n.tagName.toLocaleLowerCase() && (o = n.alt || ""),
                                                s.send("onclick", {
                                                    linkText: o.replace(/[\r\n]/g, ""),
                                                    linkUrl: ""
                                                })
                                    }
                                }
                            }
                } ();
    </script>
</head>
<body>
<div>hello world</div>

</body>
</html>
